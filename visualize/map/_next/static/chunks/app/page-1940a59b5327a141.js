(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2751:(e,t,a)=>{Promise.resolve().then(a.bind(a,7522))},7522:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>U});var r=a(5155),n=a(2115),s=a(1621),o=a(9101),l=a.n(o);a(6467);var i=a(3662);function d(e){let{points:t,onMarkerClick:a}=e,o=(0,n.useRef)(null),[d,c]=(0,n.useState)({latitude:52.370216,longitude:4.895168,zoom:12,pitch:0,bearing:0,padding:{top:0,bottom:0,left:0,right:0}});return(0,n.useEffect)(()=>{if(t.length>0){let e=t.reduce((e,t)=>e+t.latitude,0)/t.length,a=t.reduce((e,t)=>e+t.longitude,0)/t.length,r=1===t.length?10:5;o.current?o.current.flyTo({center:[a,e],zoom:r,duration:1500,essential:!0}):c(t=>({...t,latitude:e,longitude:a,zoom:r}))}else o.current?o.current.flyTo({center:[4.895168,52.370216],zoom:12,duration:1500,essential:!0}):c(e=>({...e,latitude:52.370216,longitude:4.895168,zoom:12}))},[t]),(0,r.jsxs)(s.Ay,{ref:o,...d,onMove:e=>{c(e.viewState)},style:{width:"100%",height:"100%"},mapLib:l(),mapStyle:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json",attributionControl:!0,"aria-label":"Interactive map displaying annotation points",children:[(0,r.jsx)(s.tG,{position:"top-left"}),(0,r.jsx)(s.T3,{position:"top-left"}),(0,r.jsx)(s.ov,{position:"top-left"}),(0,r.jsx)(s.g0,{}),t.map(e=>(0,r.jsx)(s.pH,{latitude:e.latitude,longitude:e.longitude,onClick:t=>{t.originalEvent.stopPropagation(),a(e)},anchor:"bottom",children:(0,r.jsx)(i.A,{className:"text-accent cursor-pointer hover:text-primary transition-colors",size:36,"aria-label":"Map marker for ".concat(e.title),fill:"currentColor",strokeWidth:1.5})},e.id))]})}var c=a(7234),u=a(2085),f=a(5318),m=a(9434);let p=c.bL;c.l9;let x=c.bm,g=c.ZL,h=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(c.hJ,{className:(0,m.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n,ref:t})});h.displayName=c.hJ.displayName;let b=(0,u.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),y=n.forwardRef((e,t)=>{let{side:a="right",className:n,children:s,...o}=e;return(0,r.jsxs)(g,{children:[(0,r.jsx)(h,{}),(0,r.jsxs)(c.UC,{ref:t,className:(0,m.cn)(b({side:a}),n),...o,children:[s,(0,r.jsxs)(c.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,r.jsx)(f.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});y.displayName=c.UC.displayName;let v=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,m.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};v.displayName="SheetHeader";let N=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(c.hE,{ref:t,className:(0,m.cn)("text-lg font-semibold text-foreground",a),...n})});N.displayName=c.hE.displayName;let j=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(c.VY,{ref:t,className:(0,m.cn)("text-sm text-muted-foreground",a),...n})});j.displayName=c.VY.displayName;var w=a(9708);let k=(0,u.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),A=n.forwardRef((e,t)=>{let{className:a,variant:n,size:s,asChild:o=!1,...l}=e,i=o?w.DX:"button";return(0,r.jsx)(i,{className:(0,m.cn)(k({variant:n,size:s,className:a})),ref:t,...l})});A.displayName="Button";var P=a(4439);let L=n.forwardRef((e,t)=>{let{className:a,children:n,...s}=e;return(0,r.jsxs)(P.bL,{ref:t,className:(0,m.cn)("relative overflow-hidden",a),...s,children:[(0,r.jsx)(P.LM,{className:"h-full w-full rounded-[inherit]",children:n}),(0,r.jsx)(S,{}),(0,r.jsx)(P.OK,{})]})});L.displayName=P.bL.displayName;let S=n.forwardRef((e,t)=>{let{className:a,orientation:n="vertical",...s}=e;return(0,r.jsx)(P.VM,{ref:t,orientation:n,className:(0,m.cn)("flex touch-none select-none transition-colors","vertical"===n&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===n&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...s,children:(0,r.jsx)(P.lr,{className:"relative flex-1 rounded-full bg-border"})})});S.displayName=P.VM.displayName;var z=a(6874),C=a.n(z);function E(e){let{point:t,onClose:a}=e;if(!t)return null;let n=e=>"string"==typeof e||"number"==typeof e||"boolean"==typeof e?String(e):e&&"object"==typeof e?(0,r.jsx)("pre",{className:"font-code text-xs bg-muted/50 p-2 rounded-md overflow-x-auto whitespace-pre-wrap break-all",children:JSON.stringify(e,null,2)}):"N/A",s=e=>"string"==typeof e?(0,r.jsx)("p",{className:"font-body text-sm break-words",children:e}):e&&"object"==typeof e?(0,r.jsx)("ul",{className:"list-disc pl-5 space-y-1 font-body text-sm",children:Object.entries(e).map(e=>{let[t,a]=e;if("latitude"===t||"longitude"===t)return null;let s="string"==typeof a&&(a.startsWith("http://")||a.startsWith("https://"));return(0,r.jsxs)("li",{className:"break-all",children:[(0,r.jsxs)("strong",{className:"font-semibold capitalize",children:[t.replace(/([A-Z])/g," $1"),":"]})," ",s?(0,r.jsx)(C(),{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:a}):n(a)]},t)})}):(0,r.jsx)("p",{className:"font-body text-sm",children:"No displayable body content."}),{fullAnnotation:o}=t,l=t.title||"Annotation Details";return(0,r.jsx)(p,{open:!!t,onOpenChange:e=>!e&&a(),children:(0,r.jsxs)(y,{className:"w-[90vw] max-w-md sm:max-w-lg bg-card text-card-foreground p-0 flex flex-col shadow-xl rounded-l-lg",side:"right","aria-label":l,children:[(0,r.jsxs)(v,{className:"p-4 sm:p-6 border-b",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)(N,{className:"font-headline text-xl sm:text-2xl text-primary truncate max-w-[calc(100%-3rem)]",title:t.title,children:t.title}),(0,r.jsx)(x,{asChild:!0,children:(0,r.jsx)(A,{variant:"ghost",size:"icon",onClick:a,"aria-label":"Close sidebar",children:(0,r.jsx)(f.A,{className:"h-5 w-5 sm:h-6 sm:w-6"})})})]}),(0,r.jsx)(j,{className:"font-body text-sm sm:text-base",children:"Details for the selected annotation."})]}),(0,r.jsx)(L,{className:"flex-1 p-4 sm:p-6",children:(0,r.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold font-headline text-base sm:text-lg mb-1",children:"Location"}),(0,r.jsxs)("p",{className:"font-body text-sm",children:["Latitude: ",t.latitude.toFixed(5)]}),(0,r.jsxs)("p",{className:"font-body text-sm",children:["Longitude: ",t.longitude.toFixed(5)]})]}),o.id&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold font-headline text-base sm:text-lg mb-1",children:"Annotation ID"}),(0,r.jsx)(C(),{href:o.id,target:"_blank",rel:"noopener noreferrer",className:"font-body text-sm text-primary hover:underline break-all",children:o.id})]}),o.motivation&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold font-headline text-base sm:text-lg mb-1",children:"Motivation(s)"}),(0,r.jsx)("p",{className:"font-body text-sm",children:Array.isArray(o.motivation)?o.motivation.join(", "):o.motivation})]}),o.body&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold font-headline text-base sm:text-lg mb-1",children:"Annotation Body"}),Array.isArray(o.body)?o.body.map((e,t)=>(0,r.jsx)("div",{className:"mb-3 p-3 border rounded-md bg-muted/30 shadow-sm",children:s(e)},t)):(0,r.jsx)("div",{className:"p-3 border rounded-md bg-muted/30 shadow-sm",children:s(o.body)})]}),o.target&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold font-headline text-base sm:text-lg mb-1",children:"Annotation Target"}),"string"==typeof o.target?(0,r.jsx)(C(),{href:o.target,target:"_blank",rel:"noopener noreferrer",className:"font-body text-sm text-primary hover:underline break-all",children:o.target}):(0,r.jsx)("pre",{className:"font-code text-xs bg-muted/30 p-3 rounded-md overflow-x-auto shadow-sm",children:JSON.stringify(o.target,null,2)})]})]})})]})})}let R=n.forwardRef((e,t)=>{let{className:a,type:n,...s}=e;return(0,r.jsx)("input",{type:n,className:(0,m.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...s})});R.displayName="Input";var M=a(172),O=a(1949);let F="https://annorepo.demo.netwerkdigitaalerfgoed.nl/w3c/atm-toekomsttiendaagse?page=0";function _(e){var t,a,r,n,s,o;let l,i;if(e&&("number"==typeof e.latitude||"string"==typeof e.latitude)&&("number"==typeof e.longitude||"string"==typeof e.longitude)){let t="string"==typeof e.latitude?parseFloat(e.latitude):e.latitude,a="string"==typeof e.longitude?parseFloat(e.longitude):e.longitude;isNaN(t)||isNaN(a)||(l=t,i=a)}if("number"==typeof l&&"number"==typeof i)return{latitude:l,longitude:i,label:e.label||e.name||("string"==typeof e.value?e.value:void 0)||"Unnamed Point"};if((null==e?void 0:e.source)&&"object"==typeof e.source){let t=_(e.source);if(t)return{...t,label:t.label||e.label||"From Source"}}if((null==e?void 0:e.value)&&"object"==typeof e.value&&(null==(t=e.value.geometry)?void 0:t.type)==="Point"&&Array.isArray(e.value.geometry.coordinates)){let[t,n]=e.value.geometry.coordinates;if("number"==typeof n&&"number"==typeof t&&!isNaN(n)&&!isNaN(t))return{latitude:n,longitude:t,label:(null==(a=e.value.properties)?void 0:a.label)||(null==(r=e.value.properties)?void 0:r.name)||e.label||"GeoJSON Point"}}if((null==e?void 0:e.selector)&&"object"==typeof e.selector&&!Array.isArray(e.selector)&&"GeoJsonSelector"===e.selector.type&&"string"==typeof e.selector.value)try{let t=JSON.parse(e.selector.value),a="Feature"===t.type?t.geometry:t;if((null==a?void 0:a.type)==="Point"&&Array.isArray(a.coordinates)){let[r,l]=a.coordinates;if("number"==typeof l&&"number"==typeof r&&!isNaN(l)&&!isNaN(r))return{latitude:l,longitude:r,label:(null==(n=t.properties)?void 0:n.label)||(null==(s=t.properties)?void 0:s.name)||(null==(o=t.properties)?void 0:o.title)||e.label||"GeoJSON Selector Point"}}}catch(e){}return null}function U(){let[e,t]=(0,n.useState)(F),[a,s]=(0,n.useState)([]),[o,l]=(0,n.useState)(null),[i,c]=(0,n.useState)(!1),[u,f]=(0,n.useState)(null),[m,p]=(0,n.useState)(!1),x=(0,n.useCallback)(async e=>{if(!e){f("Please enter an AnnotationPage URL."),s([]);return}c(!0),f(null),l(null),s([]);let t=async(e,a)=>{try{let r=await fetch(e);if(!r.ok){let t="Status: ".concat(r.status);r.statusText&&(t+=" ".concat(r.statusText));try{let e=r.headers.get("content-type");if(e&&e.includes("application/json")){let e=await r.json();e&&"object"==typeof e?e.message?t+=" - Message: ".concat(e.message):e.error&&(t+=" - Error: ".concat(e.error)):"string"==typeof e&&(t+=" - Body: ".concat(e.substring(0,100)))}}catch(e){}return{allPoints:a,errorMsg:"Fetch failed from ".concat(e,". ").concat(t)}}let n=await r.json();if("object"!=typeof n||null===n||"AnnotationPage"!==n.type||!Array.isArray(n.items))return{allPoints:a,errorMsg:"Invalid AnnotationPage format from ".concat(e,". Expected 'type: AnnotationPage' and 'items' array.")};let s=function(e){let t=[];if(!(null==e?void 0:e.items)||!Array.isArray(e.items))return t;for(let a of e.items){if("Annotation"!==a.type)continue;let e=null,r=a.body;if(Array.isArray(r)){for(let t of r)if(e=_(t))break}else"object"==typeof r&&null!==r&&(e=_(r));e&&"number"==typeof e.latitude&&"number"==typeof e.longitude&&t.push({id:a.id,latitude:e.latitude,longitude:e.longitude,title:e.label||a.label||"Annotation: ".concat(a.id.substring(a.id.lastIndexOf("/")+1)),fullAnnotation:a})}return t}(n),o=[...a,...s];if(!n.next)return{allPoints:o};if("string"!=typeof n.next||!n.next.startsWith("http://")&&!n.next.startsWith("https://"))return{allPoints:o,errorMsg:"Invalid 'next' URL received from ".concat(e,": ").concat(n.next)};return await t(n.next,o)}catch(r){let t="An unknown error occurred during fetch operation.";return r instanceof TypeError&&r.message.toLowerCase().includes("failed to fetch")?t="Network error: Failed to fetch. Please check the URL and your internet connection.":r instanceof SyntaxError?t="Failed to parse server response. Expected JSON.":r instanceof Error?t=r.message:"string"==typeof r&&(t=r),{allPoints:a,errorMsg:"Error processing ".concat(e,": ").concat(t)}}},{allPoints:a,errorMsg:r}=await t(e,[]);r?(f(r),s([])):(s(a),0===a.length?f("No annotations with geographical data found in the provided URL(s)."):f(null)),c(!1),m||p(!0)},[m]);(0,n.useEffect)(()=>{F&&!m&&x(F)},[x,m]);let g=()=>{x(e)};return(0,r.jsxs)("div",{className:"flex flex-col h-screen w-screen bg-background text-foreground overflow-hidden",children:[(0,r.jsx)("header",{className:"p-3 sm:p-4 bg-card border-b shadow-md z-20",children:(0,r.jsxs)("div",{className:"container mx-auto flex flex-col sm:flex-row gap-3 items-center",children:[(0,r.jsx)("h1",{className:"text-2xl lg:text-3xl font-headline text-primary whitespace-nowrap",children:"AnnoMap"}),(0,r.jsxs)("div",{className:"flex-grow flex gap-2 items-center w-full sm:w-auto",children:[(0,r.jsx)(R,{type:"url",placeholder:"Enter AnnotationPage URL",value:e,onChange:e=>t(e.target.value),className:"flex-grow font-body h-10 text-sm","aria-label":"AnnotationPage URL",onKeyDown:e=>"Enter"===e.key&&g()}),(0,r.jsx)(A,{onClick:g,disabled:i,className:"font-body h-10 px-4 sm:px-6",children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(M.A,{className:"mr-2 h-4 w-4 animate-spin"})," Loading..."]}):"Load Data"})]})]})}),(0,r.jsxs)("div",{className:"flex flex-1 overflow-hidden relative",children:[(0,r.jsxs)("main",{className:"flex-1 relative h-full w-full",children:[(0,r.jsx)(d,{points:a,onMarkerClick:e=>{l(e)}}),i&&0===a.length&&!u&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-background/80 z-10 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"p-6 bg-card rounded-lg shadow-xl flex items-center gap-3",children:[(0,r.jsx)(M.A,{className:"h-6 w-6 animate-spin text-primary"}),(0,r.jsx)("span",{className:"font-body text-lg",children:"Loading annotations..."})]})}),u&&(0,r.jsxs)("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 max-w-md w-[90%] z-10 p-4 bg-destructive text-destructive-foreground rounded-md shadow-xl flex items-center gap-3",children:[(0,r.jsx)(O.A,{className:"h-5 w-5 shrink-0"}),(0,r.jsx)("p",{className:"font-body text-sm",children:u})]}),!i&&!u&&0===a.length&&m&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-background/80 z-10 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"p-6 bg-card rounded-lg shadow-xl text-center",children:[(0,r.jsx)(O.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,r.jsx)("h2",{className:"text-xl font-headline mb-2",children:"No Points to Display"}),(0,r.jsxs)("p",{className:"font-body text-muted-foreground",children:['Enter a valid AnnotationPage URL above and click "Load Data" to see points on the map. ',(0,r.jsx)("br",{}),"Or, the current URL might not contain any geo-tagged annotations."]})]})})]}),(0,r.jsx)(E,{point:o,onClose:()=>{l(null)}})]})]})}},9434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>s});var r=a(2596),n=a(9688);function s(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.QP)((0,r.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[466,600,802,107,441,684,358],()=>t(2751)),_N_E=e.O()}]);